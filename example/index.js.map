{"version":3,"file":"index.js","sources":["../src/index.ts"],"sourcesContent":["interface Config {\n  container: HTMLElement;\n  keyboard: [number, number];\n  errorDuration: number;\n  onResult: (result: number[]) => void | null;\n  onChange: (result: number[]) => void | null;\n}\n\nclass Lock {\n  private _container: HTMLElement;\n  private _errorDuration: number;\n  private _errorTimer: NodeJS.Timeout | null;\n  private _keyboard: [number, number];\n  private _config: Config;\n  private _onResult: (result: number[]) => void | null | Promise<void>;\n  private _onChange: (result: number[]) => void | null;\n\n  // result collection\n  private _resultCoordinates: string[] = [];\n  private _numberMap: {\n    [key: string]: number;\n  } = {};\n\n  // record body overflow style\n  private _bodyOldOverflow = '';\n  private _width = 0;\n  private _height = 0;\n  private _radius = 0;\n  private _bgCanvas: HTMLCanvasElement;\n  private _interactionCanvas: HTMLCanvasElement;\n  private _bgCtx: CanvasRenderingContext2D;\n  private _interactionCtx: CanvasRenderingContext2D;\n\n  constructor(config: Config) {\n    this._config = Object.assign({}, {\n      keyboard: [3, 3],\n      errorDuration: 2000,\n    }, config);\n\n\n    this._container = this._config.container;\n    this._errorDuration = this._config.errorDuration;\n    this._errorTimer = null;\n    this._keyboard = this._config.keyboard;\n    this._onResult = this._config.onResult;\n    this._onChange = this._config.onChange;\n\n    this._touchmove = this._touchmove.bind(this);\n\n    // init\n    this._container.style.position = 'relative';\n    const bgCanvas = document.createElement('canvas');\n    const interactionCanvas = document.createElement('canvas');\n    this._width = this._container.getBoundingClientRect().width;\n    this._height = this._container.getBoundingClientRect().height;\n    this._radius = (Math.min(this._width, this._height) / Math.max(...this._keyboard)) / 3;\n    bgCanvas.width = interactionCanvas.width = this._width;\n    bgCanvas.height = interactionCanvas.height = this._height;\n    bgCanvas.style.position = 'absolute';\n    interactionCanvas.style.position = 'absolute';\n\n    this._bgCtx = bgCanvas.getContext('2d') as CanvasRenderingContext2D;\n    this._interactionCtx = interactionCanvas.getContext('2d') as CanvasRenderingContext2D;\n\n    this._bgCanvas = bgCanvas;\n    this._interactionCanvas = interactionCanvas;\n\n    this._container.appendChild(this._bgCanvas);\n    this._container.appendChild(this._interactionCanvas);\n\n    this._drawBg();\n    this._bindEvent();\n  }\n  _drawBg(): void {\n    const [rows, cols] = this._keyboard;\n    const rowOffset = this._width / (rows + 1);\n    const colOffset = this._height / (cols + 1);\n    for (let col = 0; col < cols; col++) {\n      for (let row = rows; row > 0; row--) {\n        const circleX = rowOffset * row;\n        const circleY = colOffset * (col + 1);\n        // 从上往下, 从右往左, 递减的绘制圆\n        this._numberMap[`${circleX}_${circleY}`] = (cols - col) * rows - (rows - row);\n        this._bgCtx.save();\n        this._bgCtx.beginPath();\n        this._bgCtx.moveTo(circleX + this._radius, circleY);\n        this._bgCtx.arc(circleX, circleY, this._radius, 0, Math.PI * 2);\n        this._bgCtx.stroke();\n        this._bgCtx.restore();\n      }\n    }\n  }\n\n  // calculate the coordinate of the hand relative to then container\n  _calculateRelativeCoordinate(clientX: number, clientY: number): {\n    relativeX: number;\n    relativeY: number;\n  } {\n    let relativeX = 0;\n    let relativeY = 0;\n\n    if (clientX && clientY) {\n      const { x: containerX, y: containerY } = this._container.getBoundingClientRect();\n      relativeX = clientX - containerX;\n      relativeY = clientY - containerY;\n    }\n    return {\n      relativeX,\n      relativeY\n    }\n  }\n\n  _clearInteraction(): void {\n    this._interactionCtx.clearRect(0, 0, this._width, this._height);\n  }\n\n  _drawInteraction(clientX: number, clientY: number, color = 'black'): void {\n\n    const {\n      relativeX, relativeY\n    } = this._calculateRelativeCoordinate(clientX, clientY);\n\n    this._calculateResult(relativeX, relativeY);\n\n    this._drawInteractionNotLastLine(color);\n    this._drawInteractionLastLine(relativeX, relativeY);\n  }\n\n  _calculateResult(relativeX: number, relativeY: number): void {\n    const [rows, cols] = this._keyboard;\n    const width = this._width;\n    const height = this._height;\n    const rowOffset = width / (rows + 1);\n    const colOffset = height / (cols + 1);\n\n    // calculate whether the hand is in the circle\n    for (let col = 0; col < cols; col++) {\n      for (let row = 0; row < rows; row++) {\n        const circleX = rowOffset * (row + 1);\n        const circleY = colOffset * (col + 1);\n        const isInCircle = Math.sqrt(Math.pow(relativeX - circleX, 2) + Math.pow(relativeY - circleY, 2)) - this._radius < 0;\n        if (isInCircle && !this._resultCoordinates.includes(`${circleX}_${circleY}`)) {\n          this._resultCoordinates.push(`${circleX}_${circleY}`);\n\n          if (this._onChange) {\n            const result = this._resultCoordinates.map(coordinate => {\n              const [x, y] = coordinate.split('_');\n              return this._numberMap[`${x}_${y}`];\n            });\n            this._onChange(result);\n          }\n        }\n      }\n    }\n  }\n\n  _drawInteractionNotLastLine(color = 'black'): void {\n    this._clearInteraction();\n    this._drawInteractionCircle(color);\n    this._drawInteractionConnectingLine(color);\n  }\n\n  _drawInteractionCircle(fillStyle = 'black'): void {\n    this._resultCoordinates.forEach(coordinate => {\n      const [pointX, pointY] = coordinate.split('_');\n      this._interactionCtx.save();\n      this._interactionCtx.beginPath();\n      this._interactionCtx.moveTo(+pointX + this._radius / 2, +pointY);\n      this._interactionCtx.fillStyle = fillStyle;\n      this._interactionCtx.arc(+pointX, +pointY, this._radius / 3, 0, Math.PI * 2);\n      this._interactionCtx.fill();\n      this._interactionCtx.restore();\n    });\n  }\n\n  _drawInteractionConnectingLine(strokeStyle = 'black'): void {\n    if (this._resultCoordinates.length === 0) {\n      return\n    }\n    const [pointX, pointY] = this._resultCoordinates[0].split('_');\n    this._interactionCtx.save();\n    this._interactionCtx.beginPath();\n    this._interactionCtx.moveTo(+pointX, +pointY);\n    this._resultCoordinates.forEach((coordinate, index) => {\n      if (index === 0) {\n        return;\n      }\n      const [pointX, pointY] = coordinate.split('_');\n      this._interactionCtx.lineTo(+pointX, +pointY);\n    });\n    this._interactionCtx.strokeStyle = strokeStyle;\n    this._interactionCtx.stroke();\n    this._interactionCtx.restore();\n  }\n\n  _drawInteractionLastLine(relativeX: number, relativeY: number): void {\n    if (this._resultCoordinates.length > 0) {\n      const [lastPointX, lastPointY] = this._resultCoordinates[this._resultCoordinates.length - 1].split('_');\n      this._interactionCtx.save();\n      this._interactionCtx.beginPath();\n      this._interactionCtx.moveTo(+lastPointX, +lastPointY);\n      this._interactionCtx.lineTo(relativeX, relativeY);\n      this._interactionCtx.strokeStyle = 'black';\n      this._interactionCtx.stroke();\n      this._interactionCtx.restore();\n    }\n  }\n\n  _feedback(): void {\n\n    const result = this._resultCoordinates.map(coordinate => {\n      const [x, y] = coordinate.split('_');\n      return this._numberMap[`${x}_${y}`];\n    });\n\n    this._interactionCanvas.removeEventListener('touchmove', this._touchmove);\n    this._drawInteractionNotLastLine();\n\n    const callback = this._onResult && this._onResult(result) as Promise<void>;\n\n    const doSuccess = (): void => this.success();\n    const doError = (): void => this.error();\n    if (Object.prototype.toString.call(callback) === '[object Promise]') {\n      this.loading();\n      callback.then(doSuccess).catch(doError)\n    }\n  }\n\n  _bindEvent(): void {\n    this._interactionCanvas.addEventListener('touchstart', e => {\n      // make it impossible to scroll while moving\n      this._bodyOldOverflow = document.body.style.overflow;\n      document.body.style.overflow = 'hidden';\n\n      this._resultCoordinates = [];\n      const { clientX, clientY } = e.touches[0];\n      if (this._errorTimer) {\n        clearTimeout(this._errorTimer);\n      }\n      this._drawInteraction(clientX, clientY);\n      this._interactionCanvas.addEventListener('touchmove', this._touchmove);\n    })\n\n    this._interactionCanvas.addEventListener('touchend', () => {\n      document.body.style.overflow = this._bodyOldOverflow;\n      if (this._resultCoordinates.length > 0) {\n        this._feedback();\n      }\n    })\n\n  }\n\n  _touchmove(e: TouchEvent): void{\n    const { clientX, clientY } = e.touches[0];\n    this._drawInteraction(clientX, clientY);\n  }\n\n  public loading(text = 'checking...'): void {\n    this._interactionCtx.save();\n    this._interactionCtx.textAlign = 'center';\n    this._interactionCtx.font = '48px serif';\n    this._interactionCtx.fillStyle = 'rgba(0, 0, 0, 0.5)';\n    this._interactionCtx.fillRect(0, 0, this._width, this._height);\n    this._interactionCtx.fillStyle = 'rgba(0, 0, 0, 1)';\n    this._interactionCtx.fillText(text, this._width / 2, this._height / 2)\n    this._interactionCtx.restore()\n  }\n\n  public error(): void {\n    this._drawInteractionNotLastLine('red');\n    this._errorTimer = setTimeout(() => {\n      this._clearInteraction();\n    }, this._errorDuration);\n  }\n\n  public success(): void {\n    this._resultCoordinates = [];\n    this._clearInteraction();\n  }\n}\n\nexport default Lock;\n\n"],"names":[],"mappings":"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"}